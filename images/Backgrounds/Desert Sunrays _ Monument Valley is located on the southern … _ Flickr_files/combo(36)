YUI.add("hermes-template-html4-balls",function(e,a){var r=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,a,r,t,l){return'\n<div class="html4-balls"></div>\n'},useData:!0}),t={};e.Array.each([],function(a){var r=e.Template.get("hermes/"+a);r&&(t[a]=r)}),e.Template.register("hermes/html4-balls",function(a,l){return l=l||{},l.partials=l.partials?e.merge(t,l.partials):t,r(a,l)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("html5-balls",function(e){var l,t=!(e.UA.ie&&e.UA.ie<9);l=function(e){return t?"html5-balls":"html4-balls"},e.augment(l,e.Attribute),e.Balls=l},"@VERSION@",{requires:["base","hermes-template-html5-balls","hermes-template-html4-balls","handlebars-helpers","template-base"]});YUI.add("fluid-share-panel-view",function(e,t){function i(e){return e.displayUrl||e.url||e.src}var s=require("hermes-core/flog")(t),a=(require("url-parse"),{}),n=["sq","q","t","s","n","w","m","z","c","b","l","h","k","3k","4k","5k","6k"],r={header:"false",footer:"false",context:"false",vr:"false"};a["embed-code-size-field"]="embed-code-text-field",a["iframe-code-size-field"]="iframe-code-text-field",a["bb-code-size-field"]="bb-code-text-field",e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.networkClasses=t.networkClasses||{},this.linkShareParams=t.linkShareParams,this.guestPassParams=t.guestPassParams||{},this.emailShareParams=t.emailShareParams,this.signedOutSharingPerms=t.signedOutSharingPerms||{},this.shareItemCount=t.shareItemCount||1,this.PERMISSIONS=[],this.guestPassParams.contentMarkedPublic&&this.PERMISSIONS.push({text:this.intlMessage({intlName:"share-modal.SHARE_PUBLIC_ONLY"}),value:"public"}),this.guestPassParams.canSharePrivate&&this.PERMISSIONS.push({text:this.intlMessage({intlName:"share-modal.SHARE_PRIVATE"}),value:"private"}),!1!==this.guestPassParams.shareNonPublic&&(this.guestPassParams.contentMarkedFriendFamily&&this.PERMISSIONS.push({text:this.intlMessage({intlName:"share-modal.SHARE_FRIENDS_AND_FAMILY"}),value:"family_and_friends"}),this.guestPassParams.contentMarkedFamily&&this.PERMISSIONS.push({text:this.intlMessage({intlName:"share-modal.SHARE_FAMILY"}),value:"family"}),this.guestPassParams.contentMarkedFriends&&this.PERMISSIONS.push({text:this.intlMessage({intlName:"share-modal.SHARE_FRIENDS"}),value:"friends"})),this.isMine=t.isMine||!1,this.cancel=!1,this.guestPasses={},this.flickrShare={recipients:[],guestpassStr:this.PERMISSIONS[0]?this.PERMISSIONS[0].value:"private",enablePrint:!1},r=e.StorageHelper.getItem("embedr-options")?JSON.parse(e.StorageHelper.getItem("embedr-options")):r,t.canVr?r.vr="true":r.vr="false",this},loadState:function(){var t=[],i=this;if(this.appContext.getViewer().nsid&&t.push(this.appContext.getModel("person-models",this.appContext.getViewer().nsid).then(function(e){i.set("me",e)})),this.guestPassParams.shareToAll)Object.keys(this.signedOutSharingPerms).forEach(function(e){i.networkClasses[e].canShare=!0});else if(this.guestPassParams.shareToSpecific)Object.keys(this.guestPassParams.shareToSpecific).forEach(function(e){i.networkClasses[e].canShare=i.guestPassParams.shareToSpecific[e].canShare,i.networkClasses[e].canNotShareTitle=i.guestPassParams.shareToSpecific[e].canNotShareTitle});else{var s={};s[this.emailShareParams.modelName+"_id"]=this.emailShareParams.modelId,this.emailShareParams.modelOwnerId&&(s.owner_id=this.emailShareParams.modelOwnerId),t.push(this._loadSharingPermissionsFromAPI(s))}return e.Promise.all(t)},_loadSharingPermissionsFromAPI:function(e){var t=this;return e.breakCache=(new Date).toISOString(),this.appContext.callAPI("flickr.sharing.canShare",e).then(function(e){e&&e.services&&e.services.service&&e.services.service.forEach(function(e){Object.keys(t.networkClasses).some(function(i){if(t.networkClasses[i].serviceId===e.serviceTypeId){if(t.networkClasses[i].canShare=!!e.canShare,"flickr"===i&&!1===t.appContext.getViewer().signedIn&&(t.networkClasses[i].canShare=!1),e.canShare||(t.networkClasses[i].canNotShareTitle=e.reason.map(function(e){return e.content}).join(", ")),130===e.serviceTypeId&&e.reason&&e.reason.length&&e.reason.some(function(e){return 3===e.code}))return t.cancelMessage=t.intlMessage({intlName:"share-modal.CANCEL_SHARE_BECAUSE_RESTRICTED"}),t.cancel=!0,!0;if(130===e.serviceTypeId){if(t.PERMISSIONS.length&&"public"!==t.PERMISSIONS[t.PERMISSIONS.length-1].value&&(t.guestpassRequired=!0),e.availableGuestpasses){1===e.guestpassRequired&&t.PERMISSIONS.length&&"public"===t.PERMISSIONS[t.PERMISSIONS.length-1].value&&t.PERMISSIONS.shift(),1===e.guestpassRequired&&(t.guestpassRequired=!0,t.guestPassParams=t.guestPassParams||{},t.guestPassParams.contentMarkedPublic=!1,t.guestPassParams.nonPublicWarning=!0);var s=!1,a=!1,n=!1;e.availableGuestpasses.guestpass.forEach(function(e){"friends"===e.content&&(s=!0),"family"===e.content&&(a=!0),"private"===e.content&&(n=!0)});for(var r=0;r<t.PERMISSIONS.length;)"friends"===t.PERMISSIONS[r].value&&!s||"family"===t.PERMISSIONS[r].value&&!a||"family_and_friends"===t.PERMISSIONS[r].value&&!a&&!s||"private"===t.PERMISSIONS[r].value&&!n?t.PERMISSIONS.splice(r,1):r++}else t.PERMISSIONS.length&&"public"===t.PERMISSIONS[t.PERMISSIONS.length-1].value&&(t.PERMISSIONS=[t.PERMISSIONS[0]]);t.flickrShare.guestpassStr=t.PERMISSIONS[0]?t.PERMISSIONS[0].value:"private"}return!0}return!1})})},function(e){s.error("Error reading canShare permissions",{err:e}),Object.keys(t.signedOutSharingPerms).forEach(function(e){t.networkClasses[e].canShare=t.signedOutSharingPerms[e].canShare})})},buildContainer:function(){var t,i=this.guestPassParams.showGuestPassDropdown&&this.isMine&&!!this.guestPassParams.type||!this.guestPassParams.contentMarkedPublic,s="";if(this.cancel)return this.setContainerWithTemplate("fluid-share-panel-error",{errorMessage:this.cancelMessage||this.intlMessage({intlName:"share-modal.CANCEL_SHARE_BECAUSE_ERROR",photoCount:this.guestPassParams.multipleItems?2:1})}),this;if(this.linkShareDisplay=this.generateLinkSharingDisplay(this.linkShareParams),s="macintosh"===e.UA.os?this.intlMessage({intlName:"share-modal.COPY_MAC"}):this.intlMessage({intlName:"share-modal.COPY_PC"}),t={networkClasses:this.networkClasses,linkShareDisplay:this.linkShareDisplay,privacyWarningString:this.linkShareParams.privacyWarningString,downloadAccessString:this.linkShareParams.downloadAccessString,showDownloadWarning:this.linkShareParams.showDownloadWarning,shareItemCount:this.shareItemCount,grabLink:this.guestPassParams.contentMarkedPublic||this.linkShareParams.generateLink?this.linkShareParams.shortURL:null,canHaveGuestpass:i,emailShareParams:this.emailShareParams,showMailPerms:this.guestPassParams.showGuestPassDropdown&&this.isMine&&this.guestPassParams.multipleItems&&this.PERMISSIONS.length>0,nonPublicWarning:this.guestPassParams.nonPublicWarning,grabLinkDefaultPermission:(i&&this.PERMISSIONS.length)>0?this.PERMISSIONS[0].text:"",copyMessage:s,choiceOfPermission:this.PERMISSIONS.length>1,displayOptions:r,showSlideshowOption:void 0!==this.linkShareParams.albumId||void 0!==this.linkShareParams.galleryId||void 0!==this.linkShareParams.userId||void 0!==this.linkShareParams.groupId||this.linkShareParams.isExplore,isEdge:this.appContext.getUA().isEdge,showOptionToEnablePrint:this.guestPassParams.showOptionToEnablePrint&&this.isMine,isMine:this.isMine},this.linkShareDisplay.embedr){var a,l=0,o=e.StorageHelper.getItem("fluid-share-panel-embedr-default-size");this.linkShareDisplay.embedr.sizes.forEach(function(e,t){if(o&&e.sizeKey===o&&(l=t,a=!0),!a){n.indexOf(e.sizeKey)>l&&(l=t)}}),t.defaultSizeStr=this.linkShareDisplay.embedr.sizes[l].sizeStr,t.defaultEmbedrCode=this.linkShareDisplay.embedr.sizes[l].embedCode,e.StorageHelper.setItem("fluid-share-panel-embedr-default-size",this.linkShareDisplay.embedr.sizes[l].sizeKey)}if(this.linkShareDisplay.bbCode){var h,d=0,c=e.StorageHelper.getItem("fluid-share-panel-bbCode-default-size");this.linkShareDisplay.bbCode.sizes.forEach(function(e,t){if(c&&e.sizeKey===c&&(d=t,h=!0),!h){n.indexOf(e.sizeKey)>d&&(d=t)}}),t.defaultBBCode=this.linkShareDisplay.bbCode.sizes[d].embedCode,t.defaultBBCodeSizeStr=this.linkShareDisplay.bbCode.sizes[d].sizeStr}if(this.linkShareDisplay.iframe){var u,m=0,p=e.StorageHelper.getItem("fluid-share-panel-iframe-default-size");this.linkShareDisplay.iframe.sizes.forEach(function(e,t){if(p&&e.sizeKey===p&&(m=t,u=!0),!u){n.indexOf(e.sizeKey)>m&&(m=t)}}),t.defaultIframeSizeStr=this.linkShareDisplay.iframe.sizes[m].sizeStr,t.defaultIframeCode=this.linkShareDisplay.iframe.sizes[m].embedCode}return this.linkShareDisplay.bbCode||this.linkShareDisplay.embedr||this.linkShareDisplay.iframe||(t.hideButtons=!0),t.moveInstructionsUp=t.hideButtons&&!t.canHaveGuestpass&&!t.choiceOfPermission,this.setContainerWithTemplate("fluid-share-panel",t),this},additionalViewClasses:function(){var e=[];return e.push("restyle"),e},activate:function(){var i=this.get("container"),s=this;if(this.registerEventHandler(i.delegate("click",function(e){e.preventDefault(),s.fire("subviewViewEvent","done-sharing")},".done-sharing")),this.guestpassRequired&&this.fire("subviewViewEvent","guestpass-required"),this.cancel)return this;this.dropdowns={},this.linkShareDisplay||(this.linkShareDisplay=this.generateLinkSharingDisplay(this.linkShareParams)),this.registerEventHandler(e.globalEvents.subscribe("window:keydown",function(t){(t.e.ctrlKey||t.e.metaKey)&&67===t.e.keyCode&&e.rapidTracker.beacon(s.name,"linkCopied-"+e.StorageHelper.getItem("fluid-share-panel-first-selected"))})),this.registerEventHandler(i.delegate(["click","keydown"],function(e){"click"!==e.type&&13!==e.keyCode||(e.preventDefault(),s._toggleLinkSelection(e,i))},".link-type-button")),this.registerEventHandler(i.delegate("change",function(e){e.currentTarget.getDOMNode().checked?(i.one(".embed-privacy-container").addClass("hide"),i.one(".embed-options-container").removeClass("hide")):(i.one(".embed-privacy-container").removeClass("hide"),i.one(".embed-options-container").addClass("hide"))},".embed-guestpass-checkbox")),this.registerEventHandler(i.delegate("click",function(e){e.preventDefault(),s._createdDropdownForEmbedIframeBB.bind(s)(e,i)},".embed-size-field")),this.registerEventHandler(i.delegate("click",function(e){e.preventDefault(),s._createGrabLinkPermissionDropdown(e,i)},".grab-link-field")),this.registerEventHandler(i.delegate("click",function(e){e.preventDefault(),s._createMailPermissionDropdown(e,i)},".mail-perm-field")),this.registerEventHandler(i.delegate("click",function(e){s.selectInput(e.target)},".bb-code-text-field, .grab-link-text-field, .embed-code-text-field")),e.use("event-touch",function(e){s.registerEventHandler(e.one("."+t).delegate("touchend",function(e){s.selectInput(e.target)},".bb-code-text-field, .grab-link-text-field, .embed-code-text-field"))}),this.registerEventHandler(i.delegate("click",function(t){s.networkClasses&&t.target.ancestor("."+s.networkClasses.flickr.className,!0)&&(t.preventDefault(),i.one(".share-panels").addClass("show-email-form"),e.rapidTracker.beacon(s.name,"emailTabClick"))},".share-link.sharing-type-enabled")),i.one(".share-by-email")&&this.registerEventHandler(i.one(".share-by-email").on("click",function(e){e.preventDefault(),s._onShareByEmail(e)})),this.registerEventHandler(i.delegate("change",function(e){e.halt(),s._updateEmbedrOptions(e)},".embed-options input")),this.isMine&&this.appContext.flipper.isFlipped("enable-guest-pass-printing")&&this.guestPassParams.showOptionToEnablePrint&&(this.registerEventHandler(i.delegate("change",s.handleChangePrintPermission.bind(s),"#enable-share-print")),this.registerEventHandler(i.delegate("change",s.handleChangePrintPermission.bind(s),"#enable-embed-print")),this.registerEventHandler(i.delegate("change",s.handleChangePrintPermission.bind(s),"#enable-email-print"))),this.setupEmailSharing();var a=this.PERMISSIONS[0].value;if(!this.linkShareParams.generateLink&&(this.guestpassRequired&&this.isMine&&-1===this.linkShareParams.url.indexOf("favorites")||"public"!==a)){"public"!==a&&i.one(".grab-link-privacy-reminder").removeClass("hide-reminder");var n=[1,1,1];"friends"===a?n=[0,1,0]:"family"===a?n=[1,0,0]:"family_and_friends"===a&&(n=[1,1,0]),this.requestGuestpass.apply(this,n)}return this.linkShareParams.generateLink&&(i.one(".grab-link-privacy-reminder").removeClass("hide-reminder"),this.generatingLink||(this.generatingLink=!0,this.startGuestpassLoader(),this.fire("subviewViewEvent","generate-link"))),this.setHighlightWidths(),i.one(".grab-link-download-reminder a").addClass("tabbable"),this},handleChangePrintPermission:function(t){t.halt();var i=this.get("container"),s=t.currentTarget.getDOMNode().checked,a=i.one(".grab-link-text-field"),n=a.getAttribute("data-perm-level"),r="public"===this.PERMISSIONS[0].value;s?(i.one("#enable-share-print").getDOMNode().checked=!0,i.one("#enable-embed-print").getDOMNode().checked=!0,i.one("#enable-email-print").getDOMNode().checked=!0):(i.one("#enable-share-print").getDOMNode().checked=!1,i.one("#enable-embed-print").getDOMNode().checked=!1,i.one("#enable-email-print").getDOMNode().checked=!1),this.isMine&&(this.startGuestpassLoader(),r&&!s?(a.set("value",this.linkShareParams.shortURL),this.updateEmbedCode(e.url(this.linkShareParams.embedUrl||this.linkShareParams.url)),this.endGuestpassLoader(),i.one(".grab-link-privacy-reminder").addClass("hide-reminder")):this.regenerateGuestPass(n))},onParentViewEvent:function(t,i){var s=this.get("container"),a=s.one(".grab-link-text-field"),n=e.StorageHelper.getItem("fluid-share-panel-first-selected")||"grabLinkItem";if("flickr-share-error"===i[0])this._onWarning(this.intlMessage({intlName:"share-modal.FLICKR_SHARE_ERROR"}));else if("flickr-share-success"===i[0]){var r=s.one(".fake-input");r.removeClass("not-empty"),r.all(".pill").remove(),s.one(".email-message-text-field").set("value",""),s.one(".email-recipient-text-field").setStyle("width","inherit"),s.one(".share-by-email").set("disabled",!0),this.contacts.resetSearch(),this.to={},this.flickrShare.recipients=[],this._onWarning(this.intlMessage({intlName:"share-modal.FLICKR_SHARE_SUCCESS"}),this.intlMessage({intlName:"share-modal.FLICKR_SHARE_SUCCESS_TITLE"}),!0)}else"guestpass-created"===i[0]?(this.guestPasses[""+i[1]]=i[2],a.set("value",i[2]),"grabLinkItem"===n&&this.selectInput(a),this.endGuestpassLoader(),this.updateEmbedCode(i[2])):"guestpass-failed"===i[0]?(s.one(".grab-link-permission-label")&&s.one(".grab-link-permission-label").set("text",this.intlMessage({intlName:"share-modal.SHARE_PUBLIC_ONLY"})),a.set("value",this.linkShareParams.shortURL),this.endGuestpassLoader(),this._onWarning(this.intlMessage({intlName:"share-modal.GUESTPASS_CREATION_FAILURE"}))):"generated-link"===i[0]&&(s.one(".grab-link-text-field").set("text",i[1]),a.set("value",i[1]),this.selectInput(a),this.endGuestpassLoader())},updateEmbedCode:function(e){var t=this.get("container"),i=t.one(".embed-code-text-field");if(i){var s=t.one(".embed-code-text-field").get("value"),a=/href=".*?"/,n='href="'+e+'"';i.set("value",s.replace(a,n)),this.linkShareDisplay.embedr.sizes.forEach(function(e){e.embedCode&&(e.embedCode=e.embedCode.replace(a,n))}),this.linkShareDisplay.embedr.sizes=this.linkShareDisplay.embedr.sizes.filter(function(e){return"o"!==e.sizeKey})}},setHighlightWidths:function(){var t,i,s,a,n=this.get("container"),r=n.one(".link-type-highlight"),l=0,o=n.one(".link-grab-type-button").getDOMNode().offsetLeft,h=e.StorageHelper.getItem("fluid-share-panel-first-selected")||"grabLinkItem";for(t=[{name:"grabLinkItem",element:n.one(".link-grab-type-button")},{name:"embedItem",element:n.one(".embed-type-button")},{name:"iframeItem",element:n.one(".iframe-type-button")},{name:"emailItem",element:n.one(".email-type-button")},{name:"bbCodeItem",element:n.one(".bbcode-type-button")}],this.highlightWidths={},a=0;a<t.length;a++)(s=t[a]).element?(l=parseInt(s.element.get("clientWidth"),10),this.highlightWidths[s.name]={width:l,left:o+"px"},o+=l+24):s.name===h&&(h="grabLinkItem");1===Object.keys(this.highlightWidths).length&&(h="grabLinkItem"),i=t.filter(function(e){return e.name===h})[0].element,r.setStyles(this.highlightWidths[h]),this._toggleLinkSelection({target:i},n)},_toggleLinkSelection:function(t,i){var s,a=i.one(".link-type-highlight"),n=t.target.ancestor(".link-type-buttons",!0).get("children").indexOf(t.target);i.one(".share-link-types").toggleClass("first-stop",0===n).toggleClass("second-stop",1===n).toggleClass("third-stop",2===n).toggleClass("fourth-stop",3===n),t.target.hasClass("link-grab-type-button")?(s=this.highlightWidths.grabLinkItem,this.selectInput(i.one(".grab-link-text-field")),e.StorageHelper.setItem("fluid-share-panel-first-selected","grabLinkItem"),e.rapidTracker.beacon(this.name,"grabLinkTabClick"),this.manageTabbables(".grab-link-only")):t.target.hasClass("embed-type-button")?(s=this.highlightWidths.embedItem,this.linkShareParams.isNonPublic||this.selectInput(i.one(".embed-code-text-field")),e.StorageHelper.setItem("fluid-share-panel-first-selected","embedItem"),e.rapidTracker.beacon(this.name,"embedTabClick")):t.target.hasClass("iframe-type-button")?(s=this.highlightWidths.iframeItem,this.selectInput(i.one(".iframe-code-text-field")),e.StorageHelper.setItem("fluid-share-panel-first-selected","iframeItem"),e.rapidTracker.beacon(this.name,"iframeTabClick")):t.target.hasClass("bbcode-type-button")?(s=this.highlightWidths.bbCodeItem,this.selectInput(i.one(".bb-code-text-field")),e.StorageHelper.setItem("fluid-share-panel-first-selected","bbCodeItem"),e.rapidTracker.beacon(this.name,"bbCodeTabClick")):t.target.hasClass("email-type-button")&&(this.appContext.getViewer().signedIn?(s=this.highlightWidths.emailItem,e.StorageHelper.setItem("fluid-share-panel-first-selected","emailItem"),e.rapidTracker.beacon(this.name,"emailTabClick")):this.fire("subviewViewEvent","confirm-sign-in"),this.manageTabbables(".email-sharing-panel")),a.setStyles(s)},_createDropdown:function(t,i,s,a,n){var r=this;n&&!n.isClosed||((n=new e.Views.FluidDroparound({appContext:this.appContext,showDropArrow:!0,hideModalOverlay:!0,classList:"over-modal",overlayClassList:"over-modal",anchorElement:t.one("."+i+" .dropdown-arrow"),observePageResize:!0,menuItems:s,forceLeft:!0,anchorOffsetHorizontal:16,closeOnResize:!0,maxHeight:280})).on("selected",function(e){n.close(),a.bind(r)(e),r.setHighlightWidths()}),n.show())},_createdDropdownForEmbedIframeBB:function(t,i){var s,r,l,o;t.target.ancestor(".embed-size-field",!0).hasClass("embed-code-size-field")?(s="embed-code-size-field",r="embedr"):t.target.ancestor(".embed-size-field",!0).hasClass("iframe-code-size-field")?(s="iframe-code-size-field",r="iframe"):t.target.ancestor(".embed-size-field",!0).hasClass("bb-code-size-field")&&(s="bb-code-size-field",r="bbCode"),l=this.linkShareDisplay[r].sizes,o=n.concat(["o"]),this._createDropdown(i,s,Object.keys(l).map(function(e){return{text:l[e].sizeStr,value:l[e].sizeKey}}).sort(function(e,t){return e.value.includes("p")&&!t.value.includes("p")?1:!e.value.includes("p")&&t.value.includes("p")?-1:o.indexOf(e.value[0])<o.indexOf(t.value[0])?-1:1}),function(t){var n;t&&t.menuItem&&(l.some(function(r){return r.sizeKey===t.menuItem.value&&(n=r.sizeKey,i.one("."+a[s]).set("value",r.embedCode),i.one("."+s).one(".embed-code-label").set("text",r.sizeStr),e.Analytics.sendClick("Embed Size: "+n,"Embed Size Change"),!0)}),e.StorageHelper.setItem("fluid-share-panel-"+r+"-default-size",n))},this.dropdowns[r])},_createGrabLinkPermissionDropdown:function(e,t){var i=this;this._createDropdown(t,"grab-link-field",this.PERMISSIONS,function(e){if(e&&e.menuItem){var s=e.menuItem.value;i._prepareRequestGuestPass.call(i,t,s,e.menuItem)}},this.dropdowns.grabLink)},_createMailPermissionDropdown:function(e,t){var i=this;this._createDropdown(t,"mail-perm-field",this.PERMISSIONS,function(e){e&&e.menuItem&&(t.one(".mail-permission-label").set("text",e.menuItem.text),i.flickrShare.guestpassStr=e.menuItem.value)},this.dropdowns.mail)},getShareByEmailPrintValue:function(){var e=this.get("container").one("#enable-email-print");return!!(this.appContext.flipper.isFlipped("enable-guest-pass-printing")&&this.guestPassParams.showOptionToEnablePrint&&this.isMine&&e)&&e.getDOMNode().checked},_onShareByEmail:function(e){var t={recipients:this.flickrShare.recipients,guestpassStr:this.flickrShare.guestpassStr,enablePrint:this.getShareByEmailPrintValue(),message:this.get("container").one(".email-message-text-field").get("value")};this.fire("subviewViewEvent","share-by-email",t)},manageTabbables:function(e){var t=this.get("container");t.all(".link-type-content:not("+e+") .tabbable").setAttribute("tabindex","-1"),t.all(e+" .tabbable").setAttribute("tabindex","0")},generateLinkSharingDisplay:function(t){var s=this,a={link:t.url,isNonPublic:t.isNonPublic},n=t.sizes?Object.keys(t.sizes):[];return n.length>0&&t.supportsEmbedr&&(a.embedr={sizes:Object.keys(t.sizes).map(function(a){return{sizeKey:a,sizeStr:s.getSizeStr(a)+" ("+t.sizes[a].width+" × "+t.sizes[a].height+")",embedCode:s.templates("fluid-share-embedr-code")({embedLink:e.url(t.embedUrl||t.url),title:t.title,farmURL:e.URLHelper.addProtocolToURL(i(t.sizes[a])),width:t.sizes[a].width,height:t.sizes[a].height,alt:t.title,displayOptions:r,showSlideshowOption:void 0!==s.linkShareParams.albumId||void 0!==s.linkShareParams.galleryId})}})}),n.length>0&&t.supportsBBCode&&(a.bbCode={sizes:Object.keys(t.sizes).map(function(a){return{sizeKey:a,sizeStr:s.getSizeStr(a)+" ("+t.sizes[a].width+" × "+t.sizes[a].height+")",embedCode:s.templates("fluid-share-bb-code")({title:t.title,farmURL:e.URLHelper.addProtocolToURL(i(t.sizes[a])),shortURL:t.shortURL,authorURL:e.url(t.authorURL),authorName:t.author})}})}),a},getSizeStr:function(e){var t="";return["sq","q"].indexOf(e)>-1?t=this.intlMessage({intlName:"common.SQUARE"}):"t"===e?t=this.intlMessage({intlName:"common.THUMBNAIL"}):["s","n","w"].indexOf(e)>-1?t=this.intlMessage({intlName:"common.SMALL"}):["sp","np","wp"].indexOf(e)>-1?t=this.intlMessage({intlName:"common.SMALL_PORTRAIT"}):["m","z","c"].indexOf(e)>-1?t=this.intlMessage({intlName:"common.MEDIUM"}):["mp","zp","cp"].indexOf(e)>-1?t=this.intlMessage({intlName:"common.MEDIUM_PORTRAIT"}):["l","h","k"].indexOf(e)>-1?t=this.intlMessage({intlName:"common.LARGE"}):["lp","hp","kp"].indexOf(e)>-1?t=this.intlMessage({intlName:"common.LARGE_PORTRAIT"}):["3k","4k","5k","6k"].indexOf(e)>-1?t=this.intlMessage({intlName:"common.XLARGE"}):"o"===e&&(t=this.intlMessage({intlName:"common.ORIGINAL"})),t},regenerateGuestPass:function(e){var t=e||this.PERMISSIONS[0].value,i=this.get("container");(this.isMine&&-1===this.linkShareParams.url.indexOf("favorites")&&(this.guestpassRequired||"public"===t)||"public"!==t)&&("public"!==t&&i.one(".grab-link-privacy-reminder").removeClass("hide-reminder"),this.guestpassLoaded=!1,this.startGuestpassLoader(),this._prepareRequestGuestPass(i,t,!1))},_prepareRequestGuestPass:function(t,i,s){var a=t.one(".grab-link-text-field"),n=t.one(".grab-link-privacy-reminder"),r=this.get("container").one("#enable-share-print"),l=0;if(s&&t.one(".grab-link-permission-label").set("text",s.text),r&&r.getDOMNode().checked&&(l=1),"public"!==i||l){var o=0,h=0,d=0;"friends"===i?o=1:"family"===i&&(h=1),"family_and_friends"===i?(h=1,o=1):"private"===i&&(d=1,h=1,o=1),a.setAttribute("data-perm-level",i),"public"!==i&&n.removeClass("hide-reminder"),this.requestGuestpass(h,o,d)}else a.set("value",this.linkShareParams.shortURL),a.setAttribute("data-perm-level",i),n.addClass("hide-reminder"),this.updateEmbedCode(e.url(this.linkShareParams.embedUrl||this.linkShareParams.url)),this.endGuestpassLoader()},requestGuestpass:function(e,t,i){var s,a=this.get("container").one(".grab-link-text-field"),n=this.get("container").one("#enable-share-print"),r=0;if(n&&n.getDOMNode().checked&&(r=1),s=""+e+t+i+r,this.guestPasses[s])return a.set("value",this.guestPasses[s]),this.updateEmbedCode(this.guestPasses[s]),this.endGuestpassLoader(),void(this.guestpassLoaded=!0);var l={is_private:i,is_family:e,is_friend:t,print:r},o=this.guestPassParams.type,h=this.guestPassParams.id;"photo"===o&&(l.photo=h),"photostream"===o&&(l.photostream=h),"set"===o&&(l.set=h),this.guestpassLoaded=!1,this.startGuestpassLoader(),this.fire("subviewViewEvent","request-guestpass",s,l)},startGuestpassLoader:function(){var e=this;setTimeout(function(){if(!e.guestpassLoaded){var t=e.get("container").one(".grab-link-loader");t.setStyle("display","block"),t.addClass("show-loader"),t.removeClass("link-ready")}},50)},endGuestpassLoader:function(){var e=this.get("container").one(".grab-link-loader");this.guestpassLoaded=!0,e.removeClass("show-loader"),setTimeout(function(){this.guestpassLoaded&&e.setStyle("display","none"),e.addClass("link-ready")}.bind(this),500)},setupEmailSharing:function(){var t=this.get("container"),i=t.one(".email-recipient-text-field"),s=this.fakeInput=t.one(".fake-input"),a=this.input=this.get("container").one('[data-field="recipient"]'),n=t.one(".email-message-text-field"),r=t.one(".share-by-email"),l=this;this.focus&&(setTimeout(function(){i.focus()},100),this.focus=!1),i&&(this.to={},this.arrow=e.Node.create('<span class="ui-dialog-arrow contact-autocomplete-arrow"></span>'),i.on("focus",function(){s.addClass("focus"),""===a.get("value")?l.contacts.hide():l.contacts.search(),l._adjustInputWidth()}),i.on("blur",function(){a.ancestor(".fake-input").one(".pill")||t.one(".email-recipient-text-field").setStyle("width","inherit")}),a.on("blur",function(){var e,t=!1;(e=l.contacts.selected)&&e.email&&(t=!0,l._makePill(e,t),l.contacts.selected=null,l.get("container").one(".fake-input").insertBefore(a,l.contacts.wrapperEl)),s.removeClass("focus")}),a.on("keydown",function(e){var t,i;8===e.keyCode?(""===this.get("value")&&(i=l.get("container").all(".pill").pop())&&i.fire("remove"),setTimeout(function(){l._adjustInputWidth()},0)):(13===e.keyCode||9===e.keyCode&&!e.shiftKey||32===e.keyCode||188===e.keyCode)&&((t=l.contacts.selected)&&t.email?(e.preventDefault(),l._makePill(t),l.contacts.selected=null,l._arrangeInput()):13!==e.keyCode||l.contacts.selected||(e.preventDefault(),""===this.get("value")&&l.get("container").one('[data-field="message"]').focus()))}),a.on("keypress",function(e){var t=this.get("value");l._adjustInputWidth(t+String.fromCharCode(e.which)),l.contacts._reposition(),this.show()}),a.on("keyup",function(t){0===e.Object.size(l.to)&&""===l.input.get("value")?r.setAttribute("disabled",!0):r.removeAttribute("disabled"),8===t.keyCode&&""===this.get("value")&&l._arrangeInput()}),n.on("keydown",function(e){9!==e.keyCode||e.shiftKey||(e.preventDefault(),r.focus())}),s.delegate("click",function(e){l._arrangeInput()},".fake-input"),s.delegate("mouseover",function(e){var t=e.currentTarget,i=s.get("clientWidth"),a=(t.get("offsetLeft"),parseInt(t.getComputedStyle("width").replace("px",""),10));i-(t.get("offsetLeft")-s.get("offsetLeft"))-a-10>0?(t.addClass("not-eol"),t.removeClass("end-of-the-line")):(t.removeClass("not-eol"),t.addClass("end-of-the-line"))},".pill"),this.contacts=new e.ContactSearchBox({el:i,appContext:this.appContext,shim:"c-contact-search-shim",signedOut:!this.appContext.getViewer().signedIn,alwaysDownward:!0,DOMContainer:t.one(".share-panel-body").getDOMNode(),loadingState:this.templates(e.Balls())(),onError:function(){i.blur(),l.contacts.hide()},onShow:function(e){var t=l.get("container"),i=l.get("container").one(".contact-list");t.on("click",function(e){"INPUT"!==e.target.get("tagName")&&"block"===i.getStyle("display")&&l.contacts.hide()})},onSelect:function(e,t){e&&e.nsid&&(l._makePill(e),l._arrangeInput())},dialogOffset:function(){var e=l.fakeInput.getDOMNode().getBoundingClientRect(),t=l.input.getDOMNode().getBoundingClientRect();return e.height-t.height+10}}))},_adjustInputWidth:function(t){var i,s,a,n=this.get("container"),r=n.one(".share-by-email"),l=this;return t=t||this.input.get("value"),0===e.Object.size(this.to)&&""===t?((s=n.one(".fake-input")).removeClass("not-empty"),i=s.get("clientWidth"),""!==n.one(".email-message-text-field").get("value").trim()&&r.setAttribute("disabled",!0),this.input.setStyle("width",i-20),setTimeout(function(){l.input.focus()},10),i):((a=e.Node.create('<span class="width-check"></span>')).set("innerHTML",escape(t)),this.get("container").appendChild(a),i=a.get("clientWidth")||0,a.remove(),this.input.setStyle("width",(i||30)+5+"px"),setTimeout(function(){l.input.focus()},10),i)},_makePill:function(e,t){var i,s=e.realname||e.email,a=this.templates("share-modal-mail-pill")({value:s}),n=this.get("container"),r=n.one(".share-by-email"),l=n.one(".fake-input"),o=this,h=encodeURIComponent(s);l.addClass("not-empty"),""!==n.one(".email-message-text-field").get("value").trim()&&r.removeAttribute("disabled"),this.to[h]=e,o.completeSameEvent&&o.completeSameEvent.detach(),(i=l.insertBefore(a,this.contacts.wrapperEl)).on("remove",function(t){e.nsid?o.contacts.showInSearch(e.nsid):e.email&&!t&&(o.input.set("value",i.one("span:first-child").get("innerHTML")),o._adjustInputWidth()),delete o.to[h],i.remove(),o.flickrShare.recipients.some(function(t,i){return!!(t.nsid&&t.nsid===e.nsid||!t.nsid&&t.name&&t.name===e.name)&&(o.flickrShare.recipients.splice(i,1),!0)})}),i.delegate("click",function(e){e.stopPropagation(),i.fire("remove",!0),o.input.focus()},".remove-tag"),i.on("dblclick",function(t){t.stopPropagation();var s=o.input;s.set("value",h),o._adjustInputWidth(h),i.replace(s),i.fire("remove"),setTimeout(function(){s.focus()},10),o.contacts.search(),o.completeSameEvent=s.once("blur",function(t){s.get("value")===h&&(o._makePill(e),o.input.set("value",""),o._arrangeInput())})}),e.nsid&&this.contacts.hideFromSearch(e.nsid),this.flickrShare.recipients.push(e),this.input.set("value",""),t||(this.input.focus(),o._adjustInputWidth())},_arrangeInput:function(){var e=this.input;this.get("container").one(".fake-input").insertBefore(e,this.contacts.wrapperEl),setTimeout(function(){e.focus()},10)},_onWarning:function(t,i,s){var a=e.Node.create(this.templates("fluid-warning")({message:t,title:i})),n=e.Node.create("<div></div>"),r=this.get("container"),l=this,o=(r.get("clientWidth")+20)/2-260,h=(r.get("clientHeight")+20)/2-60;a.setStyle("width",500),a.setStyle("height",100),a.setStyle("left",o),a.setStyle("top",h),n.setStyle("left",0),n.setStyle("top",0),n.setStyle("width","100%"),n.setStyle("height","100%"),n.addClass("warning-modal"),r.append(n),n.append(a),n.on("click",function(){n.remove(!0),s&&l.fire("subviewViewEvent","closeAll")})},_updateEmbedrOptions:function(t){var i=t.target.getData("setting"),s=t.target.getDOMNode().checked,n=this.get("container"),l=e.StorageHelper.getItem("fluid-share-panel-embedr-default-size"),o=n.one(".embed-demo-container")
;r[i]=s?"true":"false",this.linkShareDisplay=this.generateLinkSharingDisplay(this.linkShareParams),this.linkShareDisplay.embedr.sizes.some(function(e){if(e.sizeKey===l)return n.one("."+a["embed-code-size-field"]).set("value",e.embedCode),n.one(".embed-code-size-field").one(".embed-code-label").set("text",e.sizeStr),!0}),"true"===r.header?o.addClass("show-header"):o.removeClass("show-header"),"true"===r.footer?o.addClass("show-footer"):o.removeClass("show-footer"),this.selectInput(n.one(".embed-code-text-field")),e.StorageHelper.setItem("embedr-options",JSON.stringify(r))},selectInput:function(e){e.getDOMNode&&(e=e.getDOMNode()),e.setSelectionRange&&e.setSelectionRange(0,999)}})},"@VERSION@",{requires:["flickr-view","promise","hermes-template-fluid-share-panel","fluid-droparound-view","hermes-template-fluid-share-embedr-code","hermes-template-fluid-share-bb-code","hermes-template-share-modal-mail-pill","hermes-template-fluid-warning","hermes-template-fluid-share-panel-error","hermes-template-fluid-share-old-html-embed-code","hermes-template-fluid-share-old-iframe-embed-code","fluid-modal-view","contact-search-box","html5-balls","overflow-helper","url-helper","storage-helper"],optionalRequires:["global-events"],langBundles:["share-modal","common"]});YUI.add("hermes-lang-share-modal_es-us",function(a,e){a.Intl.add("hermes/share-modal","es-US",{SHARE_ON_BLOGGER:["Compartir en blogger"],SHARE_PHOTO:["Compartir foto"],SHARE_PHOTOS:["Compartir fotos"],SHARE_VIDEO:["Compartir video"],PLEASE_AUTHORIZE_FLICKR_TO_POST_ON_BLOGGER:["por favor autoriza que Flickr pueda publicar en Blogger"],SHARE_ON_FACEBOOK:["Compartir en Facebook"],PLEASE_AUTHORIZE_FLICKR_TO_POST_ON_FACEBOOK:["por favor autoriza que Flickr pueda publicar en Facebook"],SHARE_VIA_MAIL:["Compartir por correo"],SHARE_ON_TUMBLR:["Compartir en Tumblr"],PLEASE_AUTHORIZE_FLICKR_TO_POST_ON_TUMBLR:["por favor autoriza que Flickr pueda publicar en Tumblr"],PUBLISH_NOW:["Publicar ahora"],ADD_TO_QUEUE:["Añadir a la cola"],SAVE_AS_DRAFT:["Guardar como borrador"],SHARE_ON_TWITTER:["Compartir en Twitter"],PLEASE_AUTHORIZE_FLICKR_TO_POST_ON_TWITTER:["por favor autoriza que Flickr pueda publicar en Twitter"],SHARE_PHOTOSTREAM:["Compartir galería"],SHARE_ALBUM:["Compartir álbum"],SHARE_FAVORITES:["Compartir favoritas"],AUTHORIZE_TO_SHARE:["Debes autorizar a Flickr para que comparta fotos en ","${service}"],CONNECT_TO_SERVICE:["Conectarte a ","${service}"],OK_TAKE_ME_TO_MY_SETTINGS:["Muy bien, llévame a mis ajustes"],POST:["Publicar"],SHARE:["Compartir"],FRIENDS:["Amigos"],FAMILY:["Familia"],SCREEN_NAME_OR_EMAIL:["Nombre en pantalla o correo electrónico"],INCLUDE_A_MESSAGE:["Incluye un mensaje"],SHARE_THIS_VIA:["Comparte esto mediante..."],SHARE_PREFERENCES:["preferencias para compartir"],GRAB_THE_LINK:["Copiar el enlace"],SHOW_SHORT_URL:["mostrar la dirección URL corta"],INCLUDE_CONTENT_MARKED_AS:["Incluir contenido señalado como:"],PS_ITEMS_NOT_PUBLIC:["Algunos de los elementos tu galería no son públicos."],HERE_IS_PS_LINK:["Este es el enlace hacia la galería. ¡Sólo cópialo y pégalo!"],YOU_CAN_ADD_GUEST_PASS:['Para que los destinatarios puedan verlas, puedes añadir un pase de invitado [¿<a class="guest-pass-link" title="',"${title}",'" data-action="follow" href="/help/sharing/#2184">?</a>]'],ADD_A_GUEST_PASS:["Añadir un pase de invitado"],GUEST_PASS_COPY:["Los pases de invitado te permiten compartir las fotos que no son públicas. Cualquier persona puede ver tus fotos públicas en cualquier momento,ya sea si son miembros de Flickr o no. ¡Pero. Si quieres compartir fotos marcadas como amigos, familia o privadas, usa un pase de invitado. Si estás compartiendo fotos de un conjunto, puedes crear un pase de invitado que incluya cualquiera de tus fotos marcadas como amigos, familia o privada. Si estás compartiendo tu galería completa, puedes crear un Pase de invitado que incluya las fotos marcadas como amigos o familia (pero no tus fotos privadas)."],VISIT_GUESTPASS_HISTORY:['Puedes visitar tu <a href="/invite/history/guests/" data-action="follow">Historial de pases de invitado</a> en cualquier momento cuando el pase expire.'],SOMETHING_WRONG:["Ocurrió un error.<br>Actualiza tu navegador e inténtalo nuevamente."],ERROR:["Error"],OK:["OK"],SHARE_GROUP:["Compartir grupo"],MESSAGE:["Mensaje"],EMAIL:["Correo electrónico"],SIGN_IN_TO_EMAIL:["Debes iniciar sesión para compartir una foto. Inicia sesión e inténtalo de nuevo."],LINK_ACCOUNT:["Vincular cuenta"],ACCOUNT_SETTINGS:["Configuración de la cuenta"],AUTHORIZE_FLICKR:["Autorizar a Flickr a usar tu cuenta en la página Configuración de la cuenta."],COPY_TO_CLIPBOARD:["Presiona Ctrl+C (Win) o Command+C (Mac) para copiar este enlace cuando está seleccionado"],HTML_EMBED:["código HTML insertado"],EMAIL_BODY_PHOTOS:["${username}"," compartió ",{type:"plural",valueName:"count",options:{one:"${#} fotos",other:"${#} foto"}}," contigo."],EMAIL_BODY_ALBUM:["${username}"," compartió un álbum contigo."],EMAIL_BODY_PHOTOSTREAM:["${username}"," compartieron sus galerías contigo."],SHARE_PHOTOS_TO:[{type:"plural",valueName:"count",options:{one:"Compartir ${#} foto con:",other:"Compartir ${#} fotos con:"}}],SHARE_VIDEO_TO:[{type:"plural",valueName:"count",options:{one:"Compartir ${#} video con:",other:"Compartir ${#} videos con:"}}],SHARE_PHOTOSTREAM_TO:["Compartir galería con:"],SHARE_ALBUM_TO:["Compartir álbum con:"],SHARE_GALLERY_TO:["Compartir la expo en:"],SHARE_EXPLORE_TO:["Compartir página de exploración con:"],SHARE_SEARCH_TO:["Compartir resultados de búsqueda para:"],SHARE_FAVES_TO:["Compartir favoritos con:"],SHARE_ALBUMS_TO:["Compartir álbumes con:"],SHARE_GROUP_TO:["Compartir grupo con:"],FACEBOOK:["Facebook"],TUMBLR:["Tumblr"],TWITTER:["Twitter"],PINTEREST:["Pinterest"],MAIL:["Correo"],EMBED:["código HTML insertado"],EMBED_SIMPLE:["Insertar"],HTML:["HTML"],GRAB_LINK:["Copiar enlace"],BBCODE:["BBCode"],VIA_FLICKR:["Por Flickr:"],SHARE_PUBLIC_ONLY:["Solo fotos públicas"],SHARE_FRIENDS:["Incluir fotos marcadas como Amigos"],SHARE_FAMILY:["Incluir fotos marcadas como Familia"],SHARE_FAMILY_AND_FRIENDS:["Incluir fotos marcadas como Familia y amigos"],SHARE_FRIENDS_AND_FAMILY:["Incluir fotos marcadas como Familia y amigos"],SHARE_PRIVATE:["Todas las fotos: públicas y privadas"],SHARING_DISABLED:["La función de compartir está deshabilitada"],ON_FLICKR:["en Flickr"],PHOTO_PRIVATE_MESSAGE:['Esta foto es privada. Se agregará un pase de invitado [¿<a target="_blank" href="/help/sharing/">?</a>] para que los destinatarios puedan verla.'],PHOTO_FRIENDS_MESSAGE:['Solo tus amigos pueden ver esta foto. Se agregará un pase de invitado [¿<a target="_blank" href="/help/sharing/">?</a>] para que los destinatarios puedan verla.'],PHOTO_FAMILY_MESSAGE:['Solo tus familiares pueden ver esta foto. Se agregará un pase de invitado [¿<a target="_blank" href="/help/sharing/">?</a>] para que los destinatarios puedan verla.'],PHOTO_FAMILY_FRIENDS_MESSAGE:['Solo tus familiares y amigos pueden ver esta foto. Se agregará un pase de invitado [¿<a target="_blank" href="/help/sharing/">?</a>] para que los destinatarios puedan verla.'],PHOTO_CAMERAROLL_MESSAGE:["Los destinatarios podrán ver todas las fotos que hayas compartido, independientemente del nivel de privacidad."],GUESTPASS_CREATION_FAILURE:["Se produjo un error al intentar generar el enlace para compartir.  Vuelve a intentarlo."],CONTACT_SEARCH_ERROR:["Se produjo un error al intentar agregar un destinatario. Vuelve a intentarlo."],FLICKR_SHARE_ERROR:["Se produjo un error al intentar compartir en Flickr. Vuelve a intentarlo."],FLICKR_SHARE_SUCCESS:["¡Se han compartido tus elementos!"],FLICKR_SHARE_SUCCESS_TITLE:["Éxito"],CLICK_GENERATE_LINK:["Haz clic para generar un enlace para compartir"],FLICKR_SHARE:["Compartir"],COPY_MAC:["Presiona Command + C para copiar este enlace cuando esté seleccionado."],COPY_PC:["Presiona Ctrl + C para copiar este enlace cuando esté seleccionado."],CANCEL_SHARE_BECAUSE_ERROR:[{type:"plural",valueName:"photoCount",options:{one:"No se puede compartir esta foto. Inténtalo de nuevo más tarde.",other:"No se pueden compartir estas fotos. Vuelve a intentarlo más tarde."}}],LINK_PRIVACY_REMINDER:[{type:"plural",valueName:"photoCount",options:{one:"La foto privada en esta selección seguirá siendo privada. Solo podrán verla aquellas personas con las que compartas este enlace.",other:"Las fotos privadas en esta selección seguirán siendo privadas. Solo podrán verlas aquellas personas con las que compartas este enlace."}}],PHOTO_PAGE_PRIVACY_WARNING:["Esta foto seguirá siendo privada. Solo podrán verla aquellas personas con las que compartas este enlace."],CAMERAROLL_PRIVACY_WARNING:[{type:"plural",valueName:"photoCount",options:{one:"Esta foto seguirá siendo privada. Solo podrán verla aquellas personas con las que compartas este enlace.",other:"Las fotos que sean privadas en esta selección seguirán siendo privadas. Solo podrán verlas aquellas personas con las que compartas este enlace."}}],ALBUM_PRIVACY_WARNING:[{type:"plural",valueName:"photoCount",options:{one:"La foto privada en este álbum seguirá siendo privada. Solo podrán verla aquellas personas con las que compartas este enlace.",other:"Las fotos que sean privadas en este álbum seguirán siendo privadas. Solo podrán verlas aquellas personas con las que compartas este enlace."}}],PHOTOSTREAM_PRIVACY_WARNING:[{type:"plural",valueName:"photoCount",options:{one:"La foto privada en tu galería seguirá siendo privada. Solo podrán verla aquellas personas con las que compartas este enlace.",other:"Las fotos que sean privadas en tu galería seguirán siendo privadas. Solo podrán verlas aquellas personas con las que compartas este enlace."}}],CANCEL_SHARE_BECAUSE_RESTRICTED:["¡Lo sentimos! No puedes compartir fotos con restricciones."],NO_SHAREABLE_ITEMS:["No hay elementos disponibles para compartir."],CANT_SHARE_PRIVATE_GROUP_MESSAGE:['Solo los miembros de los grupos privados pueden verlos. <a data-action="follow" href="',"${inviteURL}",'">Invita amigos</a> para que se unan al grupo si quieres compartirlo.'],CANT_SHARE_PRIVATE_GROUP_TITLE:["Compartir un grupo privado"],EMBEDR_OPTION_HEADER:["Encabezado"],EMBEDR_OPTION_FOOTER:["Pie de página"],EMBEDR_OPTION_TRUNCATE:["Truncar"],EMBEDR_OPTION_SLIDESHOW:["Diapositivas"],EMBEDR_CHANGE_PRIVACY_WARNING:["¡Estás intentando incrustar una de tus fotos privadas! Si aún deseas incrustar esta foto, puedes hacerla pública seleccionando «Pública» en el menú de privacidad que se encuentra en la parte inferior de esta página."],ALBUM_DOWNLOAD_ACCESS_YOU:[{type:"plural",valueName:"photoCount",options:{one:"Solo tú podrás descargar esta foto.",other:"Solo tú podrás descargar estas fotos."}}],ALBUM_DOWNLOAD_ACCESS_FF:[{type:"plural",valueName:"photoCount",options:{one:"Solo tus amigos y familiares podrán descargar esta foto.",other:"Solo tus amigos y familiares podrán descargar estas fotos."}}],ALBUM_DOWNLOAD_ACCESS_FOLLOWING:[{type:"plural",valueName:"photoCount",options:{one:"Solo las personas que sigues podrán descargar esta foto.",other:"Solo las personas que sigues podrán descargar estas fotos."}}],ALBUM_DOWNLOAD_ACCESS_MEMBERS:[{type:"plural",valueName:"photoCount",options:{one:"Solo los miembros de Flickr podrán descargar esta foto.",other:"Solo los miembros de Flickr podrán descargar estas fotos."}}],ALBUM_DOWNLOAD_ACCESS_EVERYONE:[{type:"plural",valueName:"photoCount",options:{one:"Todos podrán descargar esta foto.",other:"Todos podrán descargar estas fotos."}}],CHANGE_DOWNLOAD_PREF:["(<a href='","${url}","'>Modificar tus preferencias de descarga</a>)"],EMBED_WITH_GUESTPASS:["Habilita la vista para invitados"],ENABLE_GUEST_PASS_PRINTING_PUBLIC:["Allow viewers to buy prints via a guest pass"],ENABLE_GUEST_PASS_PRINTING:["Allow viewers to buy prints"],MANAGE_GUEST_PASSES:["Manage your guest passes"]})},"@VERSION@",{requires:["intl"]});YUI.add("fluid-share-view",function(e,r){var t=require("hermes-core/flog")(r),a={shareRedirectURL:e.url("/window_close.html"),css:{shareBtn:"fluid-share-button",networkClasses:{twitter:{canShare:!1,className:"twitter-link",serviceId:9},facebook:{canShare:!1,className:"facebook-link",serviceId:128},tumblr:{canShare:!1,className:"tumblr-link",serviceId:12},pinterest:{canShare:!1,className:"pinterest-link",serviceId:132},flickr:{canShare:!1,className:"flickr-link",serviceId:130}}}};a.networks={facebook:{clientId:e.config.flickr.facebook.client_id,shareUrl:"https://www.facebook.com/dialog/share?app_id="+e.config.flickr.facebook.client_id+"&display=popup&redirect_uri="+encodeURIComponent(a.shareRedirectURL)+"&href="},twitter:{shareUrl:"https://twitter.com/intent/tweet?text={{tweetText}}&url={{linkToShare}}",hashTags:"#flickr"},tumblr:{shareUrl:"https://www.tumblr.com/widgets/share/tool?caption={{tumblrCaption}}&tags={{tags}}&url={{linkToShare}}"},pinterest:{shareUrl:"https://pinterest.com/pin/create/bookmarklet/?media={{displayPhotoURL}}&url={{linkToShare}}&description={{description}}"},flickr:{apiCall:"flickr.sharing.post"}},e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this.extraModalClasses=this.extraModalClasses||"","en-us"===this.appContext.lang.toLowerCase()?this.isEnglishLang=!0:this.isEnglishLang=!1,this.errorTitle=this.intlMessage({intlName:"common.OOPS"}),this.errorMessage=this.intlMessage({intlName:"share-modal.NO_SHAREABLE_ITEMS"}),this.removeOverlayOnClose=e.removeOverlayOnClose,this},loadState:function(){return e.Promise.resolve()},buildContainer:function(e){return e=e||{},this.setContainerWithTemplate("fluid-share",e),this},activate:function(){var r=this.get("container"),t="."+a.css.shareBtn,i=r.one(t);return!i||!this.isEnglish&&this.isDisabled||this.registerEventHandler(r.delegate(["click","keydown"],function(r){"click"!==r.type&&13!==r.keyCode||(r.preventDefault(),e.rapidTracker.beacon(this.subClassName,"shareButtonClick"),this.getItemCount().then(function(r){e.rapidTracker.beacon(this.subClassName,"shareButtonClickCount",{count:r})}.bind(this)),this.prepareModal(i))},t,this)),this},prepareModal:function(r){if(!this.shouldCancelModal())return this.getItemCount().then(function(t){return this.isDisabled?e.Promise.resolve(this.showErrorModal()):e.Promise.resolve(this.showModal(r,t,this.removeOverlayOnClose))}.bind(this)).catch(function(e){t.error({err:e})})},showModal:function(r,t,i){var s,n=this,o=this.getIsMine(),l=a.css.networkClasses,c=n.getTitleIntlKey(),h={intlName:"share-modal."+c};return"SHARE_PHOTOS_TO"!==c&&"SHARE_VIDEO_TO"!==c||(h.count=t),(s=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,noScroll:!0,hideModalOverlay:!1,maxHeight:!1,showFooter:!1,title:n.intlMessage(h),classList:"modal-restyle "+n.extraModalClasses,width:560,subview:new e.Views["fluid-share-panel-view"]({appContext:n.appContext,networkClasses:l,linkShareParams:this.prepareLinkShareParameters(),guestPassParams:this.getGuestPassParams(),emailShareParams:this.prepareFlickrShareParameters(),isMine:o,shareItemCount:t,signedOutSharingPerms:this.getSignedOutSharingPerms(),canVr:this.get("canVr")}),removeOverlayOnClose:i})).registerEventHandler(s.get("container").delegate(["click","keydown"],function(e){"click"!==e.type&&13!==e.keyCode||(e.preventDefault(),e.target.ancestor("."+l.facebook.className,!0)?n.preProcessShare(n.prepareFacebookShareParameters,n.shareToFacebook):e.target.ancestor("."+l.twitter.className,!0)?n.preProcessShare(n.prepareTwitterShareParameters,n.shareToTwitter):e.target.ancestor("."+l.tumblr.className,!0)?n.preProcessShare(n.prepareTumblrShareParameters,n.shareToTumblr):e.target.ancestor("."+l.pinterest.className,!0)&&n.preProcessShare(n.preparePinterestShareParameters,n.shareToPinterest))},".share-link.sharing-type-enabled")),s.on("share-by-email",function(r){var t=e.merge(n.prepareFlickrShareParameters(),r);n.shareToFlickr(s,t)}),s.on("done-sharing",function(r){s.close(),n.guestPassURLs={},e.rapidTracker.beacon(this.subClassName,"doneSharingClick")}),s.on("request-guestpass",function(e,r,t){n.requestGuestpass(s,r,t,!0)}),s.on("generate-link",function(){n.generateLink().then(function(e){s.fire("parentViewEvent","generated-link",e)})}),s.on("activated",function(){s.get("subview").cancel&&s.get("container").one(".title").setHTML(n.intlMessage({intlName:"common.OOPS"})),s.reposition()}),s.on("guestpass-required",function(){n.guestpassRequired=!0}),s.on("confirm-sign-in",function(){s.close();var r=new e.Views.FluidModal({appContext:n.appContext,title:n.intlMessage({intlName:"common.OOPS"}),message:n.intlMessage({intlName:"share-modal.SIGN_IN_TO_EMAIL"}),actionButtonLabel:n.intlMessage({intlName:"common.OK"}),classList:"sharing-sign-out-modal",showCancelButton:!0});r.on("actionClick",function(){e.StorageHelper.setItem("signedOutEmailSharing",new Date),e.SigninHelper.addPendingShare({shareType:"email"})}),setTimeout(function(){r.show()},10)}),s.on("close",function(){n.fire("sharePresentationClose"),n.guestPassURLs={},e.rapidTracker.beacon(n.name,"shareModalCancelClick")}),s.on("closeAll",function(){n.fire("sharePresentationClose"),s.close(),n.guestPassURLs={}}),s.show(),this.sharePresentation=s,s},showErrorModal:function(){var r=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,showCancelButton:!1,noScroll:!0,hideModalOverlay:!1,showFooter:!0,title:this.errorTitle,message:this.errorMessage});return r.show(),r},prepareFacebookShareParameters:function(){return{url:"",count:1}},prepareTwitterShareParameters:function(){return{shortURL:"",url:"",title:"",count:1}},prepareTumblrShareParameters:function(){return{title:"",authorURL:"",ownerName:"",description:"",displayPhotoURL:"",url:"",count:1}},preparePinterestShareParameters:function(){return{title:"",description:"",displayPhotoURL:"",shortURL:"",url:"",count:1}},prepareFlickrShareParameters:function(){return{modelName:"",modelId:"",title:"",url:"",count:1}},prepareLinkShareParameters:function(){return{sizes:{},url:"",title:"",author:"",authorURL:"",shortURL:"",supportsEmbedr:!1,supportsBBCode:!1,privacyWarningString:"",generateLink:!1}},getTitleIntlKey:function(){return"SHARE_PHOTOS_TO"},getItemCount:function(){return e.Promise.resolve(1)},getIsMine:function(){return!1},getGuestPassParams:function(){return{type:null,id:null,contentMarkedFriends:!0,contentMarkedFamily:!0,contentMarkedFriendFamily:!0,contentMarkedPublic:!0,canSharePrivate:!1,sharingEntirelyNotPublic:!1,multipleItems:!1,nonPublicWarning:null,shareToAll:!1,showGuestPassDropdown:!1,shareToSpecific:null}},getSignedOutSharingPerms:function(){return{facebook:{canShare:!0},twitter:{canShare:!0},tumblr:{canShare:!0},pinterest:{canShare:!0},flickr:{canShare:!1}}},shouldCancelModal:function(){return!1},shareToFacebook:function(r,i){if(!r.url)return t.error("Error sharing to Facebook.  Missing url.");var s,n,o,l,c,h=encodeURIComponent(e.url(r.url)),u=this.guestPassURLs;this.guestpassRequired&&u&&(n=u[100],o=u["010"],l=u[110],c=u[111],o&&(h=o),n&&(h=n),l&&(h=l),c&&(h=c)),s=a.networks.facebook.shareUrl+h,e.rapidTracker.beacon(this.get("parentViewName"),"shareNetworkClick",{type:"facebook",count:r.count||1}),i?i.location.replace(s):i=this.createSharePopup(s),this.trackShareCompletion(i)},shareToTwitter:function(r,i){if(void 0===r.url||null===r.url)return t.error("Error sharing to Twitter.  Missing url.");if(!r.title)return t.error("Error sharing to Twitter.  Missing title.");var s,n,o,l,c=r.title;n=""===r.url?"":encodeURIComponent(r.url),(l=c+" "+a.networks.twitter.hashTags).length+n.length>140&&(o=l.length+n.length-140,l=c.substring(0,c.length-(o+1))+"… "+a.networks.twitter.hashTags),s=a.networks.twitter.shareUrl.replace("{{tweetText}}",encodeURIComponent(l)).replace("{{linkToShare}}",n),i?i.location.replace(s):i=this.createSharePopup(s),e.rapidTracker.beacon(this.get("parentViewName"),"shareNetworkClick",{type:"twitter",count:r.count||1}),this.trackShareCompletion(i)},shareToTumblr:function(r,i){if(!r.title)return t.error("Error sharing to Tumblr.  Missing title.");if(!r.displayPhotoURL)return t.error("Error sharing to Tumblr.  Missing displayPhotoURL.");var s,n,o,l,c,h=r.title,u=r.tags||"",p=r.description,d=e.URLHelper.addProtocolToURL(r.displayPhotoURL),m=r.isPhotoPage,g=a.networks.tumblr.shareUrl;m&&this.appContext.flipper.isFlipped("enable-tumblr-embed-share")||(g+="&shareSource=legacy&posttype=photo&content={{displayPhotoURL}}&clickthroughUrl={{linkToShare}}"),r.authorURL&&(n=e.url(r.authorURL)),r.ownerName&&(o=r.ownerName),l=0===r.url.indexOf("https://")?r.url:0===r.url.indexOf("//")?e.URLHelper.addProtocolToURL(r.url):e.url(r.url),s=this.templates("fluid-share-tumblr-post")({title:h,ownerURL:n,ownerName:o,description:p,linkToShare:l}),c=g.replace("{{displayPhotoURL}}",encodeURIComponent(d)).replace("{{tumblrCaption}}",encodeURIComponent(s)).replace(/{{linkToShare}}/g,encodeURIComponent(l)).replace("{{tags}}",encodeURIComponent(u)),e.rapidTracker.beacon(this.get("parentViewName"),"shareNetworkClick",{type:"tumblr",count:r.count||1}),i?i.location.replace(c):i=this.createSharePopup(c,!0)},shareToPinterest:function(r,i){if(!r.title)return t.error("Error sharing to Pinterest.  Missing title.");if(!r.displayPhotoURL)return t.error("Error sharing to Pinterest.  Missing displayPhotoURL.");if(!r.url)return t.error("Error sharing to Pinterest.  Missing url.");if(!r.shortURL)return t.error("Error sharing to Pinterest.  Missing shortURL.");var s,n,o,l=e.Handlebars.helpers.stripTags(r.description)||"",c=r.shortURL,h=r.title,u=e.URLHelper.addProtocolToURL(r.displayPhotoURL);n=encodeURIComponent(e.url(r.url)),o=""!==l.trim()?c+" | "+h+" | "+l:c+" | "+h,u=u.replace("https:","http:"),n=n.replace("https:","http:"),s=a.networks.pinterest.shareUrl.replace("{{displayPhotoURL}}",encodeURIComponent(u)).replace("{{description}}",encodeURIComponent(o)).replace("{{linkToShare}}",n),e.rapidTracker.beacon(this.get("parentViewName"),"shareNetworkClick",{type:"pinterest",count:r.count||1}),i?i.location.replace(s):i=this.createSharePopup(s,!0)},shareToFlickr:function(r,i){if(!i.recipients)return t.error("Error sharing to Flickr.  Missing recipients.");if(!i.url)return t.error("Error sharing to Flickr.  Missing url.");if(!i.modelName)return t.error("Error sharing to Flickr.  Missing modelName.");if(!i.modelId)return t.error("Error sharing to Flickr.  Missing modelId.");var s,n,o=i.modelName,l=i.modelId,c=i.recipients,h=i.message||"",u=i.guestpassStr||"public",p=i.enablePrint||!1,d={},m=[],g=[];encodeURIComponent(e.url(i.url)),"share_code"===o?d[o]=l:d[o+"_id"]=l,d.service_type_id="130",d.owner_id=this.appContext.getViewer().nsid,"public"!==u&&("friends"!==u&&"family_and_friends"!==u||(d.guestpass_friends="1"),"family"!==u&&"family_and_friends"!==u||(d.guestpass_family="1"),"private"===u&&(d.guestpass_private="1",d.guestpass_friends="1",d.guestpass_family="1")),p&&(d.guestpass_print=1);for(s in c)(n=c[s]||{}).email?m.push(n.email):n.nsid&&g.push(n.nsid);d.to_flickr=g.join(","),d.to_email=m.join(","),d.message=e.flutil.escapeInput(h),e.rapidTracker.beacon(this.get("parentViewName"),"shareNetworkClick",{type:"flickr",count:i.count||1,flkcnt:g.length,emailcnt:m.length});var f=e.StorageHelper.getItem("signedOutEmailSharing");if(f){var k;try{(k=e.moment(f)).isValid()&&(new e.moment).diff(k,"hours")<2&&(e.rapidTracker.beacon(this.get("parentViewName"),"signedOutEmailShare",{count:i.count||1}),e.StorageHelper.remove("signedOutEmailSharing"))}catch(e){}}if(!a.networks)throw new Error("Missing sharing api configuration.");this.appContext.callAPI(a.networks.flickr.apiCall,d).then(function(){r&&r.fire("parentViewEvent","flickr-share-success")},function(e){r&&r.fire("parentViewEvent","flickr-share-error")})},generateLink:function(){var r=this;return this.onBeforeShare().then(function(e){return e},function(t){r.sharePresentation.fire("closeAll"),setTimeout(function(){new e.Views.FluidModal({appContext:r.appContext,title:r.intlMessage({intlName:"common.OOPS"}),message:r.intlMessage({intlName:"share-modal.CANCEL_SHARE_BECAUSE_ERROR",photoCount:r.getGuestPassParams.multipleItems?10:1}),actionButtonLabel:r.intlMessage({intlName:"common.OK"}),classList:"sharing-failure-modal",showCancelButton:!1}).show()},10)})},preProcessShare:function(e,r){var a=this;if(this.onBeforeShare){var i=this.createSharePopup("",!0);try{i.document.body.innerHTML=a.templates("fluid-share-loading-state")()}catch(e){18===e.code&&(i.close(),(i=this.createSharePopup("",!0)).document.body.innerHTML=a.templates("fluid-share-loading-state")())}this.onBeforeShare().then(function(s){var n;try{n=e.call(a)}catch(e){t.error("Error getting share parameters",{err:e})}r.call(a,n,i)})}else{var s;try{s=e.call(a)}catch(e){t.error("Error getting share parameters",{err:e})}r.call(a,s)}},trackShareCompletion:function(r){var a=function(i){if(i.source===r)if(i.origin===e.url("/")&&"Window closed"===i.data)t.log("Closing Facebook window."),e.rapidTracker.beacon(this.get("parentViewName"),"photoSharedToFacebook"),e.config.win.removeEventListener("message",a,!1);else if(i.origin===e.url("/")&&0===i.data.indexOf("share failure"))t.error("Got Facebook error",{data:i.data}),e.config.win.removeEventListener("message",a,!1);else if("https://twitter.com"===i.origin&&"__ready__"!==i.data)try{t.log("Tracking share completion",{data:i.data}),"tweet"===JSON.parse(i.data).params[0]&&i.returnValue&&(e.rapidTracker.beacon(this.get("parentViewName"),"photoSharedToTwitter"),e.config.win.removeEventListener("message",a,!1))}catch(e){t.error("Error tracking share completion",{err:e})}};e.config.win.addEventListener("message",a,!1)},createSharePopup:function(r,t){var a={},i="",s="nativeShare"+(new Date).getTime();return a.width=t?950:640,a.height=480,a.top=(e.config.win.screen.height-a.height)/2,a.left=(e.config.win.screen.width-a.width)/2,e.Object.each(a,function(e,r){i+=r+"="+e+","}),i=i.slice(0,-1),e.config.win.open(r,s,i)},requestGuestpass:function(e,r,t,a){var i=this;this.guestPassURLs||(this.guestPassURLs={}),this.guestPassURLs[r]?e.fire("parentViewEvent","guestpass-created",r,this.guestPassURLs[r]):this.appContext.callAPI("flickr.sharing.createGuestpass",t).then(function(t){if(!t||!t.guestpass||!t.guestpass.url)throw new Error("No guestpass returned");i.guestPassURLs[r]=t.guestpass.url,e.fire("parentViewEvent","guestpass-created",r,i.guestPassURLs[r])},function(s){a?i.requestGuestpass(e,r,t):e.fire("parentViewEvent","guestpass-failed",s)})}},{ATTRS:{parentViewName:{value:""}}})},"@VERSION@",{requires:["flickr-view","flickr-promise","fluid-modal-view","hermes-template-fluid-share","hermes-template-fluid-share-tumblr-post","hermes-template-fluid-share-loading-state","fluid-share-panel-view","url","flutil","url-helper","signin-helper","handlebars-helpers"],optionalRequires:["fluid"],langBundles:["share-modal","common"]});YUI.add("fluid-share-photo-view",function(e,t){e.FlickrView.create(this.name,e.namespace("Views")["fluid-share-view"],[],{langBundles:this.details.langBundles,subClassName:t,initializer:function(e){return this.nsid=e.nsid,this.photoId=e.photoId,this.constructor.superclass.initializer.call(this,e)},loadState:function(){var t=this;return e.Promise.all([this.appContext.getModel("photo-models",this.photoId),this.appContext.getModel("photo-privacy-models",this.photoId),this.appContext.getModel("photo-engagement-models",this.photoId),this.appContext.getModel("photo-tags-models",this.photoId)]).then(function(e){return t.set("photoModel",e[0]),t.set("privacyModel",e[1]),t.set("engagementModel",e[2]),t.set("photoTagsModels",e[3]),t.set("tags",t.get("photoTagsModels").getValue("tags").toJSON()),t.get("photoModel").canVr().then(function(e){t.set("canVr",e)})})},buildContainer:function(){var e=2===this.get("photoModel").getValue("safetyLevel");return this.get("photoModel").getValue("owner").id!==this.appContext.getViewer().nsid&&(e=e||!this.get("privacyModel").getValue("isPublic")),this.constructor.superclass.buildContainer.call(this,{extraShareButtonIconClassList:"share-photo-icon",showShareButtonLabel:!1,sharingDisabled:e,shareTooltip:this.intlMessage({intlName:"share-modal.SHARE_PHOTO"})}),this},prepareFacebookShareParameters:function(){return{url:this.get("photoModel").getValue("url")}},prepareTwitterShareParameters:function(){var t=this.get("photoModel");return{url:e.URLHelper.getShortURL(t.getValue("id")),title:t.getValue("title")||this.intlMessage({intlName:"common.UNTITLED"})}},prepareTumblrShareParameters:function(){var e=this.get("photoModel"),t=e.getValue("owner"),i=e.getLargestSize({excludeSizes:["o"]}).displayUrl,a=this.appContext.flipper.isFlipped("enable-flickr-embeds-on-tumblr");return{title:e.getValue("title")||this.intlMessage({intlName:"common.UNTITLED"}),authorURL:t.getValue("url"),ownerName:t.getValue("displayname"),description:e.getValue("description"),displayPhotoURL:a?e.getValue("url"):i,url:e.getValue("url"),isPhotoPage:!0,tags:this.get("tags").map(function(e){return e.tagRaw}).join(",")}},preparePinterestShareParameters:function(){var t=this.get("photoModel");return{title:t.getValue("title")||this.intlMessage({intlName:"common.UNTITLED"}),description:t.getValue("description"),displayPhotoURL:t.getLargestSize({excludeSizes:["o"]}).displayUrl,shortURL:e.URLHelper.getShortURL(t.getValue("id")),url:t.getValue("url"),count:1}},prepareFlickrShareParameters:function(){var e=this.get("photoModel");return{title:e.getValue("title")||this.intlMessage({intlName:"common.UNTITLED"}),modelName:"photo",modelId:e.getValue("id"),url:e.getValue("url"),count:1}},prepareLinkShareParameters:function(){var t,i=this.get("photoModel"),a=this.get("privacyModel"),o=this.get("engagementModel").getValue("canShare");return t=!(!o||!this.get("photoModel").getValue("isVideo"))||o&&!this.get("photoModel").getValue("isVideo"),{url:e.config.win.location.pathname,author:i.getValue("owner").getValue("displayname"),authorURL:i.getValue("owner").getValue("url"),shortURL:e.URLHelper.getShortURL(i.getValue("id")),supportsEmbedr:t,supportsBBCode:o,sizes:i.getValue("sizes"),title:i.getValue("title")||this.intlMessage({intlName:"common.UNTITLED"}),secret:i.getValue("secret"),privacyWarningString:this.intlMessage({intlName:"share-modal.PHOTO_PAGE_PRIVACY_WARNING"}),aspectRatio:i.getValue("aspectRatio"),isNonPublic:!a.getValue("isPublic")}},getTitleIntlKey:function(){return this.get("photoModel").getValue("isVideo")?"SHARE_VIDEO_TO":"SHARE_PHOTOS_TO"},getGuestPassParams:function(){var e,t=this.get("privacyModel"),i=t.getValue("isVisibleByFriends"),a=t.getValue("isVisibleByFamily"),o=!t.getValue("isPublic"),l=this.get("photoModel"),s=l.getValue("isVideo"),r=6===t.getValue("permPrint"),n=l.getValue("isOwner");return a&&i?e=this.intlMessage({intlName:"share-modal.PHOTO_FAMILY_FRIENDS_MESSAGE"}):a?e=this.intlMessage({intlName:"share-modal.PHOTO_FAMILY_MESSAGE"}):i?e=this.intlMessage({intlName:"share-modal.PHOTO_FRIENDS_MESSAGE"}):o&&(e=this.intlMessage({intlName:"share-modal.PHOTO_PRIVATE_MESSAGE"})),{type:"photo",id:this.photoId,contentMarkedFriends:n&&i&&!a,contentMarkedFamily:n&&a&&!i,contentMarkedFriendFamily:n&&a&&i,contentMarkedPublic:!o&&!a&&!i,canSharePrivate:n&&o&&!a&&!i,showGuestPassDropdown:n&&o,multipleItems:!1,sharingEntirelyNotPublic:n&&o,showOptionToEnablePrint:n&&!s&&!r,nonPublicWarning:e}},getIsMine:function(){return this.get("photoModel").getValue("isOwner")},getSignedOutSharingPerms:function(){var e=this.get("engagementModel").getValue("canShare");return{facebook:{canShare:e},twitter:{canShare:e},tumblr:{canShare:e},pinterest:{canShare:e},flickr:{canShare:!1}}},onParentViewEvent:function(e,t){"enable-sharing"!==t[0]&&"disable-sharing"!==t[0]||this.buildContainer()},shouldCancelModal:function(){var e=2===this.get("photoModel").getValue("safetyLevel");return e&&this.buildContainer(),e},destructor:function(){this.fire("destroy")}})},"@VERSION@",{requires:["flickr-view","flickr-promise","fluid-share-view","url-helper","flutil"],langBundles:["models","share-modal"]});YUI.add("hermes-template-print-button",function(e,n){var a=e.Template.Handlebars.revive({1:function(e,n,a,t,r){var i;return" "+e.escapeExpression("function"==typeof(i=null!=(i=a.iconSize||(null!=n?n.iconSize:n))?i:a.helperMissing)?i.call(null!=n?n:{},{name:"iconSize",hash:{},data:r}):i)},compiler:[7,">= 4.0.0"],main:function(e,n,a,t,r){var i;return'<div class="print-button-container">\n\t<a role="button" class="print-button">\n\t\t<svg class="icon icon-cart_hollow'+(null!=(i=a.if.call(null!=n?n:{},null!=n?n.iconSize:n,{name:"if",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?i:"")+'"><use xlink:href="#icon-cart_hollow"></use></svg>\n\t</a>\n</div>'},useData:!0}),t={};e.Array.each([],function(n){var a=e.Template.get("hermes/"+n);a&&(t[n]=a)}),e.Template.register("hermes/print-button",function(n,r){return r=r||{},r.partials=r.partials?e.merge(t,r.partials):t,a(n,r)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-print-icon-tooltip",function(e,a){var n=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,a,n,t,s){var i=null!=a?a:{},l=n.helperMissing,r=e.escapeExpression;return'<div class="print-icon-tooltip-container">\n\t<header>\n\t\t<h3>'+r((n.intlMessage||a&&a.intlMessage||l).call(i,{name:"intlMessage",hash:{intlName:"common.NEW"},data:s}))+'</h3>\n\t\t<svg class="close-x-button"><use xlink:href="#icon-close"></use></svg>\n\t</header>\n\t<div class="print-icon-description">\n\t\t<span>'+r((n.intlMessage||a&&a.intlMessage||l).call(i,{name:"intlMessage",hash:{intlName:"prints.PRINT_TOOLTIP_TEXT_1"},data:s}))+'</span>\n\t\t<a href="/prints">'+r((n.intlMessage||a&&a.intlMessage||l).call(i,{name:"intlMessage",hash:{intlName:"common.LEARN_MORE"},data:s}))+'</a>\n\t</div>\n\t<div class="print-icon-fine-print">'+r((n.intlMessage||a&&a.intlMessage||l).call(i,{name:"intlMessage",hash:{intlName:"prints.PRINT_TOOLTIP_TEXT_2"},data:s}))+"</div>\n</div>\n"},useData:!0}),t={};e.Array.each([],function(a){var n=e.Template.get("hermes/"+a);n&&(t[a]=n)}),e.Template.register("hermes/print-icon-tooltip",function(a,s){return s=s||{},s.partials=s.partials?e.merge(t,s.partials):t,n(a,s)})},"@VERSION@",{requires:["template-base","handlebars-base"]});